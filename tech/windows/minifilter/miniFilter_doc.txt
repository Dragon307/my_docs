
-----------------------------------------------------------------------------

Windows Driver Samples

https://github.com/Microsoft/Windows-driver-samples.git

minifilter 的例子代码在 /filesys/miniFilter 下面。

-----------------------------------------------------------------------------

Windows SDK 下载

https://developer.microsoft.com/zh-cn/windows/downloads/sdk-archive

目前最新的Windows SDK 版本是：Windows 10 SDK (10.0.14393.0)

注：Windows SDK 和 Windows Driver Kit (WDK) 版本号必须要一致，而且必须先装 Windows SDK 再装 WDK，否则 VisualStudio 无法正常使用新安装的 WDK ！

-----------------------------------------------------------------------------

Windows Driver Kit (WDK) 介绍和向导

https://msdn.microsoft.com/en-us/library/windows/hardware/ff557573(v=vs.85).aspx

Windows Driver Kit -- Windows 驱动程序工具包 (WDK)

https://developer.microsoft.com/zh-cn/windows/hardware/windows-driver-kit

目前最新的Windows SDK 版本是：Windows 10 WDK (10.0.14393.0)

-----------------------------------------

Windows Driver Kit (WDK) 10.0.x (适用于 VS 2015)

https://go.microsoft.com/fwlink/p/?LinkId=526733

支持的操作系统：

Windows 10
Windows 8.1
Windows 8
Windows 7
Windows Server 2016
Windows Server 2008 R2

WDK 8.1.x (适用于 Windows 8.1、8 和 7 驱动程序, 适用于 VS 2013)

https://go.microsoft.com/fwlink/p/?LinkId=393659

WDK 7.1.0（适用于 Windows XP 驱动程序)

https://www.microsoft.com/download/confirmation.aspx?id=11800

GRMWDK_EN_7600_1.ISO

https://download.microsoft.com/download/4/A/2/4A25C7D5-EFBE-4182-B6A9-AE6850409A78/GRMWDK_EN_7600_1.ISO

-----------------------------------------------------------------------------

File System Minifilter Drivers

https://msdn.microsoft.com/en-us/windows/hardware/drivers/ifs/file-system-minifilter-drivers

微软 minifilter 的官方文档首页

-----------------------------------------------------------------------------

Windows文件系统过滤管理器之微过滤器驱动开发指南

http://blog.csdn.net/celestialwy/article/details/694044

简单评价：转载的文章，编辑得还不错。挺长的，内容比较繁杂，不太容易懂，需要有基础才能看懂，但也可以看看。


节选：

此文的原文是《Filter Driver Development Guide》，出自微软的网站。我在以下这个地址下载得到此文:

http://download.microsoft.com/download/e/b/a/eba1050f-a31d-436b-9281-92cdfeae4b45/FilterDriverDeveloperGuide.doc

我尽量在翻译中使文章保持原貌。如果您认为此文无法理解，建议您首先阅读旧的文件过滤驱动的相关资料。我认为必须有文件系统和windows驱动的相关知识，才能阅读此文。


-----------------------------------------------------------------------------

MiniFilter文件系统学习

http://blog.csdn.net/zhuhuibeishadiao/article/details/51229122

简单评价：还不错，各种文章整理在一起，稍微有点杂乱，但覆盖面比较广，值得一看。

-----------------------------------------------------------------------------

'fltKernel.h' missing when trying to build driver Visual Studio 2012?

http://stackoverflow.com/questions/31859483/fltkernel-h-missing-when-trying-to-build-driver-visual-studio-2012

Folder: C:\Program Files (x86)\Windows Kits\8.0\Include\km

I assume that's with the Windows 8 WDK? Just make sure that the header was installed in your kits header directory ("C:\Program Files (x86)\Windows Kits\8.0\Include\km"). Also note that fltKernel.h is a kernel mode header, so you can only include it in kernel mode driver projects.

If the header is missing from your installation, I'd recommend reinstalling the WDK. If it is not missing and it still isn't found for some reason, you could try manually adding its absolute path to your list of included headers to see if it fixes the issue. If that works (it should), then you can figure out why it was missing from your include path in the first place.


-----------------------------------------------------------------------------

Minifilter微过滤框架：框架介绍以及驱动层和应用层的通讯

http://blog.csdn.net/arvon2012/article/details/7926366

简单评价：还不错，文章不长，比较初级的介绍，可以看看。

其他转载地址：http://www.cnblogs.com/findumars/p/6012381.html


节选：

minifilter是sfilter后微软推出的过滤驱动框架。相比于sfilter，他更容易使用，需要程序员做的编码更简洁。

系统为minifilter专门制作了一个过滤管理器，这个管理器本身其实是一个传统过滤驱动，它向minifilter的使用者提供许多接口，让原本复杂的文件过滤驱动变得方便简单。之所以简单是因为传统的过滤驱动把大量的工作放在绑定设备上，而现在这些工作都交给minifilter中的过滤管理器来完成。

缺点：纯粹的使用minifilter提供的接口看不见设备对象和IRP的，所以编程自由度不大。


对minifilter的编写的第一步是向过滤管理器注册一个微过滤器，这个未过滤器是一个组件，包含了一些在文件操作的时候可能需要的回调函数。

驱动入口中最简单的版本是只包含两个函数：注册函数和开始函数。


-----------------------------------------------------------------------------

Minifilter的动态安装、加载及卸载

http://www.cnblogs.com/js2854/archive/2011/04/03/sysload.html

简单评价：如题，Minifilter驱动的动态安装，加载和卸载，评论里有讨论自动启动的处理方法。

-----------------------------------------------------------------------------

[MiniFilter]驱动隐藏文件夹的实现（支持Win7）

http://www.cnblogs.com/js2854/archive/2010/11/03/HideDir.html

说明：WinXP 和 Win7 以上版本的代码是不一样。

-----------------------------------------------------------------------------

File System Minifilter Drivers（文件系统微型过滤驱动）入门

http://www.cnblogs.com/monotone/p/4184219.html

-----------------------------------------------------------------------------

Windows Minifilter驱动 - 加载顺序 （2）

http://blog.csdn.net/zj510/article/details/39345479

驱动启动类型

看MSDN: http://msdn.microsoft.com/en-us/library/windows/hardware/ff557272(v=vs.85).aspx

vs2013默认使用的是SERVICE_DEMAND_START。 也就是说系统重启后minifilter不会被加载。需要通过Pnp管理器或者SCM来启动。比如使用命令sc start myminifilter。

当windows启动的时候，SERVICE_BOOT_START和SERVICE_SYSTEM_START的minifilter驱动会被自动加载。SERVICE_BOOT_START比SERVICE_SYSTEM_START的驱动更早被加载。MSDN:However, no system-start driver is loaded until after all boot drivers have been loaded.

对于同一种类型的驱动，加载顺序就看他们所属的组了。

-----------------------------------------------------------------------------

Windows Minifilter驱动 - 获取进程ID, 进程名字和线程ID （5）

http://blog.csdn.net/zj510/article/details/39476171

-----------------------------------------------------------------------------

Win10 下 VS2015（WDK10）驱动开发环境配置

http://blog.csdn.net/liuyez123/article/details/50857621

简单评价：有较为详细的使用 VS2015(WDK 10) 连接远程调试机（或虚拟机）的步骤介绍。

-----------------------------------------------------------------------------

WinDB G实时打印 Windows 驱动或者内核信息的方法
http://blog.csdn.net/md521/article/details/37704363

在 Windows 7 用 WinDBG 调试时显示 KdPrint 信息
http://blog.chinaunix.net/uid-701988-id-373702.html

4.　当WinDBG调试窗口加载符号表未出现错误信息时，在WinDBG中命令行中输入以下命令：

    ed kd_default_mask 0xffffffff       // 不区分大小写，用于打开Windows驱动或者内核调试筛选器

-----------------------------------------------------------------------------

Debugger里面如何得到DbgPrintEx的输出

http://advdbg.org/forums/2269/ShowPost.aspx

你是在Driver里面用的DbgPrintEx,我当时是断在了ntdll!DbgPrintEx里面了,我跟了一下,发现,这个里面确实有一个filter的,就是后面这个,ntdll!NtQueryDebugFilterState,后者是一个SysCall,根据DbgPrintEx的参数ComponentId来做Mask, 貌似设置nt!Kd_WIN2000_Mask成0xffffffff后,所有的component都不会被mask,也就会被show出来了.

-----------------------------------------------------------------------------

DbgPrintEx 的执行流程和参数说明：
http://blog.csdn.net/vins_security_lab/article/details/47294225

    DbgPrintEx(DPFLTR_FASTFAT_ID, DPFLTR_ERROR_LEVEL, "Error!\n");
    DbgPrintEx(DPFLTR_FASTFAT_ID, DPFLTR_WARNING_LEVEL, "Warning!\n");
    DbgPrintEx(DPFLTR_FASTFAT_ID, DPFLTR_TRACE_LEVEL, "Trace!\n");
    DbgPrintEx(DPFLTR_FASTFAT_ID, DPFLTR_INFO_LEVEL, "Info!\n");

    DbgPrintEx(DPFLTR_FASTFAT_ID, DPFLTR_BEFORE_LEVEL, "Before!\n");
    DbgPrintEx(DPFLTR_FASTFAT_ID, DPFLTR_MIDDLE_LEVEL, "Middle!\n");
    DbgPrintEx(DPFLTR_FASTFAT_ID, DPFLTR_AFTER_LEVEL, "After!\n");

------------------------------------------------------

minispy!DriverEntry

1: kd> eb nt!Kd_WIN2000_Mask 0

1: kd> dyd nt!Kd_WIN2000_Mask
           3          2          1          0
          10987654 32109876 54321098 76543210
          -------- -------- -------- --------
82948bbc  00000000 00000000 00000000 00000000  00000000

1: kd> eb nt!Kd_FASTFAT_Mask 0y1010000

1: kd> dyd nt!Kd_FASTFAT_Mask
           3          2          1          0
          10987654 32109876 54321098 76543210
          -------- -------- -------- --------
82956f2c  00000000 00000000 00000000 01010000  00000050

------------------------------------------------------

dyd nt!Kd_WIN2000_Mask

dyd nt!Kd_DEFAULT_Mask
dyd nt!Kd_FASTFAT_Mask

0: kd> dyd nt!Kd_DEFAULT_Mask
           3          2          1          0
          10987654 32109876 54321098 76543210
          -------- -------- -------- --------
83d4aec8  11111111 11111111 11111111 11111111  ffffffff

dyd nt!Kd_FLTMGR_Mask

0: kd> dyd nt!Kd_FLTMGR_Mask
           3          2          1          0
          10987654 32109876 54321098 76543210
          -------- -------- -------- --------
83d4adf0  00000000 00000000 00000000 00000000  00000000

eb nt!Kd_FLTMGR_Mask 0y1010000

eb nt!Kd_FLTMGR_Mask 0y11111111   (用于使用的是 eb 命令，最大只能8个bit)

ed nt!Kd_FLTMGR_Mask 0xffffffff

-----------------------------------------------------------------------------

